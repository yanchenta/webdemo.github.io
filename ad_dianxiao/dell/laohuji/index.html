
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0,  minimum-scale=1.0, maximum-scale=1.0" />
<meta name="keywords" content="">
<meta name="description" content="">
<title>DELL 激发无限</title>
<link href="css/index.css"  type="text/css" rel="stylesheet" />
<script src="js/jquery.min.js"></script>
<script src="js/jquery.cookie.js"></script>
<script src="js/trackEvent.js"></script>
<script src="js/easing.js"></script>
<script src="js/guid.js"></script>
<style>
html,body{background-color:#fff;}
</style>
<script>
var uid;
$(document).ready(function(){
	uid = $.cookie('uid');
	if(!uid){
		uid = Guid.NewGuid().ToString();
		$.cookie('uid',uid);
	}
});
function choujiang(){
	
	var userInfo = {
		advid : '10019',
		userinfo : uid
	};
	$.ajax({
		url : 'http://test.zhangkuo.net/advmessage/advtrophy/awardJsonP.action',
		type:"POST",
		cache : false,
		dataType : 'jsonp',
		data : userInfo,
		success : function(result) {
			if(result[0].award == 1){
				play(getResult(result[0].prize.prizeid));
				_code = result[0].code;
			}else{
				play(getResult(0));
			}
		},error:function(xhr){
			showMsg("网络出错，请刷新页面！");
		}
	});
}
var ss = ['001','002','011','012','021','022','100','101','102','110','112','121','122','201','202','211','212','221'];
var _r = 3;
var eventid = 5873;
var _code;
function getResult(a){
	var b = '123';
	if(a == 0 || a== "0"){
		b = ss[parseInt(Math.random()*ss.length)];
		_r = -1;
		eventid = 5873;
	}else if(a == 26 || a == "26"){
		b = '000';
		_r = 0;
		eventid = 5876;
	}else if(a == 27 || a == "27"){
		b = '111';
		_r = 1;
		eventid = 5875;
	}else if(a == 28 || a == "28"){
		b = '222';
		_r = 2;
		eventid = 5874;
	}else if(a == 29 || a == "29"){
		b = '333';
		_r = 3;
		eventid = 5874;
	}
	return b;
}
var isBegin = false;
function play(result){
	var u = $(".num").width();
	
	if(isBegin) return false;
	isBegin = true;
	$(".num").css('backgroundPositionY',0);
	var num_arr = (result+'').split('');
	$(".num").each(function(index){
		var _num = $(this);
		setTimeout(function(){
			_num.animate({ 
				backgroundPositionY: (u*300) - (u*num_arr[index])
			},{
				duration: 6000+index*3000,
				easing: "easeInOutCirc",
				complete: function(){
					if(index==2){
						isBegin = false;
						//$.cookie("isPlay",'0');
						if(_r > -1){
							location = 'wx.html?r=' + _r + '&code=' + _code;
						}else{
							showMsg("未中奖");
						}
					}
					//var pos = _num.css('backgroundPositionY').replace('px','');
					//_num.css('backgroundPositionY',pos%u);
				}
			});
		}, index * 300);
	});
}
function showMsg(msg){
	alert(msg);
}
</script>
</head>

<body>
<div class="fxbg">
<img class="img" src="images/index.jpg" alt="" />
<div class="btn1">
	<a href="javascript:choujiang();" id="a1_1" class="fly"></a>
		<div class="num_box fly">
		  <div class="num"></div>
		  <div class="num"></div>
		  <div class="num"></div>
		</div>
</div>
</div>
</body>
</html>
